
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel=stylesheet href='include/hoj.css' type='text/css'>
</head>
<body>
<center>
<div style="width:90%; text-align:left">
<img src="image/logo.png"/>
</div>
<table width=96%> 
	<tr align="center" class='hd' valign="top">
				<th><a href="https://www.lydsy.com/JudgeOnline/faqs.php">F.A.Qs</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/">Home</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/bbs.php">Discuss</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/problemset.php">ProblemSet</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/status.php">Status</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/ranklist.php">Ranklist</a></th>
        <th><a href="https://www.lydsy.com/JudgeOnline/contest.php">Contest</a></th>
        <th><a href="http://begin.lydsy.com/JudgeOnline">入门OJ</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/modifypage.php"><b>ModifyUser</b></a>&nbsp;&nbsp;<a href='https://www.lydsy.com/JudgeOnline/userinfo.php?user=Xeonacid'>
				<font color=red>Xeonacid</font></a></th><th><a href="https://www.lydsy.com/JudgeOnline/logout.php">Logout</a></th>		<th><a href="https://www.lydsy.com/JudgeOnline/donation.php"><font color=red>捐赠本站</font></a></th>
	</tr>
</table>
</center>
<center>
<div class="notice">
	<div>
		<B>Notice:</B>注册本OJ方式请见https://www.lydsy.com/JudgeOnline/wttl/thread.php?tid=5671	</div>
</div>
</center>
</div>
<title>Problem 3291. -- Alice与能源计划</title><center><h2>3291: Alice与能源计划</h2><span class=green>Time Limit: </span>10 Sec&nbsp;&nbsp;<span class=green>Memory Limit: </span>512 MB<br><span class=green>Submit: </span>73&nbsp;&nbsp;<span class=green>Solved: </span>36<br>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3291'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3291'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3291'>Discuss</a>]</center><h2>Description</h2><div class=content><div>在梦境中，Alice来到了火星。不知为何，转眼间Alice被任命为火星能源部长，并立刻面临着一个严峻的考验。为</div>
<div>了方便，我们可以将火星抽象成平面，并建立平面直角坐标系。火星上一共有N个居民点。每个居民点认为是平面</div>
<div>上的一个点。第i个居民点的坐标为(Xi,Yi），对能源的需求量为Poweri。每个居民点消耗的能源由它附近的发电</div>
<div>站提供。由于技术原因，一个居民点消耗的所有能源必须来自同一座发电站。自人类移民火星之初，政府就有一个</div>
<div>规模宏大的发电站建设计划。按照这个计划，政府将在火星上建立M座发电站，这M座发电站将是火星居民的全部能</div>
<div>量来源。其中，第i座发电站的坐标为(xi,yi)，产生能量的上限值为Limiti，建设费用为Pricei。同样由于技术原</div>
<div>因，第i座发电站只能为与它的距离不超过Ri的居民点提供能源。然而，由于政府的财政状况一直十分紧张，截至</div>
<div>目前，这M座发电站中只有少量建成并投入使用，多数的发电站尚未开始建设。Alice的任务是修改这个计划，使得</div>
<div>它更符合实际情况。根据新的规定，一座发电站产生的所有能源必须提供给同一个居民点。Alice知道这个规定意</div>
<div>味着N个居民点消耗的能源将分别由N座不同的发电站提供，而且为第i个居民点提供能源的那座发电站的Limit值一</div>
<div>定不小于Poweri。Alice需要在原计划的M座发电站中选择恰好N座发电站，并完全放弃剩余的M-N座发电站，使得这</div>
<div>N座发电站能够满足N个居民点的需要。对于一个可行的方案，设方案中选择的N座发电站构成集合S，而已经建成的</div>
<div>发电站构成集合T，那么定义这个方案的代价为即，一个方案的代价等于被选择的且尚未建成的发电站的建设费用</div>
<div>之和加上没有被选择的且已经建成的发电站的建设费用之和。在所有可行方案中，你必须帮助Alice找到代价最小</div>
<div>的方案，并将选择的N座发电站按编号从小到大的顺序输出。如果代价最小的方案不唯一，则输出其中字典序最小</div>
<div>的方案。</div>
<div>注意，输入文件包含多组测试数据。</div></div><h2>Input</h2><div class=content><div>第一行包含一个正整数T，表示有T组测试数据。接下来依次是T组测试数据。</div>
<div>每组测试数据的第一行包含两个整数N、M。</div>
<div>接下来N行，每行3个整数：Xi、Yi、Poweri。</div>
<div>再接下来M行，每行6个整数：xi、yi、Limiti、Pricei、Ri、Finishedi。</div>
<div>若Finishedi=1，表示第i座发电站已经建成；否则Finishedi=0，表示第i座发电站尚未开始建设。</div>
<div>1&le;N&le;400，1&le;M&le;500，1&le;T&le;10，0&le;xi,yi,Xi,Yi,Pricei&le;10000，</div>
<div>1&le;Ri,Poweri,Limiti&le;10000。不同的居民点或发电站的坐标有可能重合。</div>
<div>关于方案的字典序的大小关系的说明：</div>
<div>设方案A选择的N座发电站的编号从小到大依次为A1,A2,&hellip;,AN；</div>
<div>设方案B选择的N座发电站的编号从小到大依次为B1,B2,&hellip;,BN。</div>
<div>我们称方案A比方案B字典序更小，当且仅当存在正整数i，满足1&le;i&le;N，</div>
<div>使得对任意1&le;k&le;i-1有Ak=Bk，且Ai&lt;Bi。</div></div><h2>Output</h2><div class=content><div class="pdcont">
<div>对于每组测试数据：</div>
<div>若存在可行方案则输出两行。第一行为一个整数，表示最小代价；</div>
<div>第二行是若干个递增的整数，表示字典序最小的最优方案选择的发电站的编号。</div>
<div>若不存在可行方案，则仅输出一行为一个整数-1。</div>
</div></div><h2>Sample Input</h2>
			<div class=content><span class=sampledata>4<br />
1 1<br />
4 4 1<br />
8 7 1 2 5 1<br />
2 3<br />
0 0 3<br />
2 0 2<br />
1 1 5 1 3 0<br />
1 0 5 1 1 1<br />
3 0 5 1 3 0<br />
2 3<br />
0 0 3<br />
2 0 2<br />
1 1 2 0 3 0<br />
1 0 1 0 1 1<br />
3 0 3 0 2 0<br />
2 3<br />
0 0 3<br />
2 0 2<br />
1 1 4 2 2 0<br />
1 0 2 9 1 1<br />
3 0 5 4 2 1<br />
<br />
</span></div><h2>Sample Output</h2>
			<div class=content><span class=sampledata>0<br />
1<br />
1<br />
1 2<br />
-1<br />
6<br />
1 2<br />
样例说明<br />
第1组测试数据：<br />
只有一个居民点，其坐标为(4,4)，能源需求量Power1=1；仅一座发电站，其坐标为(8,7)，产生的能量上限Limit1<br />
=1，建设费用Price1=2，服务范围半径R1=5，Finished1=1表示已经建成。<br />
两个点之间的距离等于5不超过R1，并且Power1≤Limit1。因此唯一的可行方案是花费0的代价保留1号发电站，使<br />
它为1号居民点提供能源。<br />
第2组测试数据：任意选择两个发电站都是一个可行方案。最小代价是1，对应的方案有两种：选择1号和2号发电站；选择2号和3号发电站。而前者的字典序更小。<br />
第3组测试数据：不存在可行方案。<br />
第4组测试数据：代价最小的方案唯一：选择1号和2号发电站，代价为6。</span></div><h2>HINT</h2>
			<div class=content><p></p></div><h2>Source</h2>
			<div class=content><p><a href='https://www.lydsy.com/JudgeOnline/problemset.php?search='></a></p></div><center>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3291'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3291'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3291'>Discuss</a>]</center>﻿<br>
<a href="https://www.lydsy.com/JudgeOnline/"><span class=red>HOME</span></a>
<a href="javascript:history.go(-1)"><span class=red>Back</span></a>

<hr>
<center>
	<div class="footer">
			<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=ko">한국어</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=cn">中文</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=fa">فارسی</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=en">English</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=th">ไทย</a>
	<br>		<div>版权所有 &copy;2008-2018 大视野在线测评</div>
		<div>Based on opensource project <a href="http://hustoj.googlecode.com">hustoj</a>.</div>
	</div>
</center>
</body>
</html>
