
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel=stylesheet href='include/hoj.css' type='text/css'>
</head>
<body>
<center>
<div style="width:90%; text-align:left">
<img src="image/logo.png"/>
</div>
<table width=96%> 
	<tr align="center" class='hd' valign="top">
				<th><a href="https://www.lydsy.com/JudgeOnline/faqs.php">F.A.Qs</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/">Home</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/bbs.php">Discuss</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/problemset.php">ProblemSet</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/status.php">Status</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/ranklist.php">Ranklist</a></th>
        <th><a href="https://www.lydsy.com/JudgeOnline/contest.php">Contest</a></th>
        <th><a href="http://begin.lydsy.com/JudgeOnline">入门OJ</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/modifypage.php"><b>ModifyUser</b></a>&nbsp;&nbsp;<a href='https://www.lydsy.com/JudgeOnline/userinfo.php?user=Xeonacid'>
				<font color=red>Xeonacid</font></a></th><th><a href="https://www.lydsy.com/JudgeOnline/logout.php">Logout</a></th>		<th><a href="https://www.lydsy.com/JudgeOnline/donation.php"><font color=red>捐赠本站</font></a></th>
	</tr>
</table>
</center>
<center>
<div class="notice">
	<div>
		<B>Notice:</B>注册本OJ方式请见https://www.lydsy.com/JudgeOnline/wttl/thread.php?tid=5671	</div>
</div>
</center>
</div>
<title>Problem 3604. -- [Sdoi2014]电路板</title><center><h2>3604: [Sdoi2014]电路板</h2><span class=green>Time Limit: </span>30 Sec&nbsp;&nbsp;<span class=green>Memory Limit: </span>512 MB<br><span class=green>Submit: </span>16&nbsp;&nbsp;<span class=green>Solved: </span>5<br>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3604'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3604'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3604'>Discuss</a>]</center><h2>Description</h2><div class=content><p>对于用户给出的电路图和指定大小的电路板，Alice和Bob需要将电路在电路板上实现出来。&nbsp;</p>
<div>所谓电路板，可以看作是一个n*m的格子图。&nbsp;</div>
<div>用户给定的电路由若干电路原件组成，每一个电路原件可能会占用一个或多个格子。这里，我们将被电路原件占据的格子分为两类。第一类只是纯粹占据了这个格子，之后这个格子不会再被使用，也不会从被占据的位置连出去任何的电路线。这样的格子被我们视作是电路板上的障碍物。还有一类格子，我们称为是电路原件的接口，上面虽然被电路原件占用，但是仍有可能从其中连出去一些电路线到其它的电路原件上，从而形成电路。&nbsp;</div>
<div>对于电路图中一些链接某两个原件的电路线，我们可以指定为电路板上的k个格子对，要求每对格子对之间连一条电路线。&nbsp;</div>
<div>同一个格子可能属于多个格子对（比如一些并联电路）。&nbsp;</div>
<div>任意两条电路线不能相交（但可以连接到同一个有着电路原件的格子中），且电路板上的每一个格子的每一条边都只能经过一条电路线。（所以每一个电路原件的接口上只能接出去最多4条不同的电路线）。然而，每一个不被电路原件占用的格子内却可以经过多条电路&nbsp;</div>
<div>线。&nbsp;</div>
<div>具体来说：为了保证电路线不相交，可以一条电路线从上边界进入当前格子，从左边界离开这个格子，另外一条电路线可以从下边界进入格子，从右边界出去。（需要注意的是：电路线本身是没有方向感念的，即格子对描述的边关系是无向边。所以这样的方案也可以描述为从左边界进入后从上边界出去，从右边界进入后从下边界出去）相似的方案还有好几种。&nbsp;</div>
<div>现在，Alice希望找到一个可行方案，使得路径的总长度最短。而Bob则希望知道满足最短长度的方案有多少种。&nbsp;</div>
<div></div></div><h2>Input</h2><div class=content><p>&nbsp;第一行三个整数，n,m,k，表示电路板的大小，以及需要连接电路线的格子对个数。&nbsp;</p>
<div>接下来m行，每行n个整数，为0或1。0代表当前格子可以用，否则表示有障碍，不能使用。&nbsp;</div>
<div>接下来k行，每行4个整数x1,y1,x2,y2，给出一组格子对，表示对应的电路要连接&nbsp;</div>
<div>的两个格子。格子的行列都从0开始编号，所以0&lt;=x1,x2&lt;n，0&lt;=y1,y2&lt;m。&nbsp;</div>
<div>本题有多组数据（最多30组），输入文件最后以0 0 0 结束。&nbsp;</div>
<div></div></div><h2>Output</h2><div class=content><p>对于每组数据，输出两个整数，最短电线长度和最短电线长度的方案数。&nbsp;</p>
<div>
<div>方案数只需要输出对25619849取余数后的结果。&nbsp;</div>
<div>如果无解，输出-1 0。</div>
<div></div>
</div></div><h2>Sample Input</h2>
			<div class=content><span class=sampledata>4 4 4<br />
0 0 0 0<br />
0 0 0 0<br />
0 0 0 0<br />
0 0 0 0<br />
1 2 2 1<br />
2 1 1 2<br />
1 2 2 1<br />
2 1 1 2<br />
4 4 2<br />
0 0 1 1<br />
0 0 0 0<br />
1 0 0 0<br />
0 0 0 0<br />
1 0 2 2<br />
0 0 3 0<br />
0 0 0</span></div><h2>Sample Output</h2>
			<div class=content><span class=sampledata>16 96<br />
12 1</span></div><h2>HINT</h2>
			<div class=content><p><p>&nbsp;样例解释：&nbsp;</p><br />
<div>第一组数据：(1,2)与(2,1)之间有4条路径，立刻可以发现，最短路径长度和为16。对于每一种可行方案，任意一条(1,2)与(2,1)之间的路径都可以对应要求的4条路径中的任何一条。而若就形态来说，完全不同的方案有4种，考虑到排列数4!＝24，所以总的方案为96种。&nbsp;</div><br />
<div>第二组数据：因为有3个障碍点，所以可行路径只有一条。&nbsp;</div></p></div><h2>Source</h2>
			<div class=content><p><a href='https://www.lydsy.com/JudgeOnline/problemset.php?search='></a></p></div><center>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3604'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3604'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3604'>Discuss</a>]</center>﻿<br>
<a href="https://www.lydsy.com/JudgeOnline/"><span class=red>HOME</span></a>
<a href="javascript:history.go(-1)"><span class=red>Back</span></a>

<hr>
<center>
	<div class="footer">
			<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=ko">한국어</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=cn">中文</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=fa">فارسی</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=en">English</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=th">ไทย</a>
	<br>		<div>版权所有 &copy;2008-2018 大视野在线测评</div>
		<div>Based on opensource project <a href="http://hustoj.googlecode.com">hustoj</a>.</div>
	</div>
</center>
</body>
</html>
