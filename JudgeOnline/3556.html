
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link rel=stylesheet href='include/hoj.css' type='text/css'>
</head>
<body>
<center>
<div style="width:90%; text-align:left">
<img src="image/logo.png"/>
</div>
<table width=96%> 
	<tr align="center" class='hd' valign="top">
				<th><a href="https://www.lydsy.com/JudgeOnline/faqs.php">F.A.Qs</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/">Home</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/bbs.php">Discuss</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/problemset.php">ProblemSet</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/status.php">Status</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/ranklist.php">Ranklist</a></th>
        <th><a href="https://www.lydsy.com/JudgeOnline/contest.php">Contest</a></th>
        <th><a href="http://begin.lydsy.com/JudgeOnline">入门OJ</a></th>
		<th><a href="https://www.lydsy.com/JudgeOnline/modifypage.php"><b>ModifyUser</b></a>&nbsp;&nbsp;<a href='https://www.lydsy.com/JudgeOnline/userinfo.php?user=Xeonacid'>
				<font color=red>Xeonacid</font></a></th><th><a href="https://www.lydsy.com/JudgeOnline/logout.php">Logout</a></th>		<th><a href="https://www.lydsy.com/JudgeOnline/donation.php"><font color=red>捐赠本站</font></a></th>
	</tr>
</table>
</center>
<center>
<div class="notice">
	<div>
		<B>Notice:</B>注册本OJ方式请见https://www.lydsy.com/JudgeOnline/wttl/thread.php?tid=5671	</div>
</div>
</center>
</div>
<title>Problem 3556. -- [Ctsc2014] 插线板</title><center><h2>3556: [Ctsc2014] 插线板</h2><span class=green>Time Limit: </span>80 Sec&nbsp;&nbsp;<span class=green>Memory Limit: </span>256 MBSec&nbsp;&nbsp;<span class=red>Special Judge</span><br><span class=green>Submit: </span>29&nbsp;&nbsp;<span class=green>Solved: </span>6<br>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3556'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3556'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3556'>Discuss</a>]</center><h2>Description</h2><div class=content><p>&nbsp;Allison有非常多的电子设备，比如iMac,iPod,iPhone和iPad。所以她准备购买插线板来给电子设备充电。在做了大量的网络调研后，</p>
<div>Allison拔线了一款美丽精巧的天翼牌排插（如左下图所示）。在见到这个插线板的第一眼，Allison就被它的境美造型所吸引，</div>
<div>于是她一次性购买了n个这种型号的插线板。&nbsp;</div>
<div>&nbsp;可是问题也随之而来，Allison的家中只有一个插座，她需要通过插线板的连接将电一层一层地导出（如右上图所示）。&nbsp;</div>
<div>插线板的连接方式是树形结构的：每个插线板的插头插在另一个插线板的插空中（除了根节点），插线板的连接不允许构成环。&nbsp;</div>
<div>每个插线板有火线，零线，地线三根导线，随着插线板数量的增加、倒显得磨损，电路中导线与导线之间接触产生的电阻已经到了</div>
<div>不能被忽视的地步。&nbsp;</div>
<div>如何来描述插线板的树形结构以及导线之间的电阻关系呢？Allison思考出来一个数学模型：用ai代表第i个插线板的编号，fi代表</div>
<div>第i个插线板的插头所差的插线板（即ai在树中的父亲），1代表火线，2代表零线，3代表地线，则整个网络的电阻可以用</div>
<div>R(ai,fi,x,y)(x,y&isin;{1,2,3})来描述，它代表ai的x线与fi的y线之间的电阻值（在这个数学模型中，Allison认为火线和领先也是</div>
<div>可能连接并且产生电阻的）下面是一个例子：&nbsp;</div>
<div>&nbsp;<img src="upload/201505/1111.jpg" width="450" height="411" alt="" /></div>
<div>由于时间的推移，导线与导线之间的电阻还可能发生变化。现在，Allison想知道在插线板树形电路中，当前时刻ai插线板的x线和</div>
<div>aj插线板的y线之间的电阻式多少。规定插线板的树根节点不再插向其他插线板，且编号为1。&nbsp;</div></div><h2>Input</h2><div class=content><p>&nbsp;第一行包含一个正整数n，表示插线板的个数。&nbsp;</p>
<div>接下来4(n-1)行，每4行为一个块。&nbsp;</div>
<div>第i块的第一行为一个整数fi【注：原题如此。实际应该是fi+1，下同】，表示编号为i+1的插线板的父亲为fi【注：同上】插线板。&nbsp;</div>
<div>接下来一个3*3的矩阵gxy，第x行第y个数表示编号为i+1的插线板的x线和fi【注：同上】的y线之间的电阻的倒数。&nbsp;</div>
<div>接下来一个整数q，表示q个操作数。&nbsp;</div>
<div>第一个整数位k，若k=1则接下来包含四个整数ai,xi,xj,g，表示将ai插线板的xi线与ai插线板的父亲fi</div>
<div>【注：原题如此。实际应该是fai】的xj线之间的电阻值改为g的倒数。保证2&lt;=ai&lt;=n。&nbsp;</div>
<div>若k=2，则接下来包含四个整数ai,xi,aj,xj，表示询问ai插线板的xi线与aj插线板的xj线之间的电阻大小。保证ai&ne;aj。&nbsp;</div></div><h2>Output</h2><div class=content><p>对每个询问，输出一行实数，表示两条线之间的电阻。&nbsp;</p>
<div>若|(选手输出-标准输出)/标准输出|&lt;=10^-3，则被认为该电阻值正确，若所有电阻值皆正确，则可获得该测试点的得分。&nbsp;</div></div><h2>Sample Input</h2>
			<div class=content><span class=sampledata>3<br />
1<br />
6 7 1 <br />
4 1 8 <br />
8 3 3 <br />
2<br />
7 5 8 <br />
10 5 7 <br />
10 5 5 <br />
10<br />
1 3 1 2 2<br />
1 2 2 3 5<br />
2 3 2 2 2<br />
1 2 3 2 5<br />
1 3 1 2 3<br />
2 1 2 2 3<br />
1 3 2 1 2<br />
2 2 1 1 1<br />
1 2 1 2 5<br />
2 3 1 1 2</span></div><h2>Sample Output</h2>
			<div class=content><span class=sampledata>0.083836<br />
0.095256<br />
0.078828<br />
0.146900</span></div><h2>HINT</h2>
			<div class=content><p><p>&nbsp;对于所有测试数据，输入保证是一棵树。0&lt;输入中电阻的倒数&lt;=10。&nbsp;</p><br />
<div>测试点编号 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;特点</div><br />
<div>&nbsp; &nbsp;1-6 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;n&lt;=100,q&lt;=1000，保证输入中只有查询没有修改</div><br />
<div>&nbsp; &nbsp;7-10 &nbsp; &nbsp; &nbsp; &nbsp; n&lt;=1000,q&lt;=1000，保证数据是一条链</div><br />
<div>&nbsp; &nbsp;11-16 &nbsp; &nbsp; &nbsp; &nbsp;n&lt;=10000,q&lt;=10000，保证数的高度不超过30</div><br />
<div>&nbsp; &nbsp;17-20 &nbsp; &nbsp; &nbsp; &nbsp;n&lt;=10000,q&lt;=10000</div><br />
<div></div></p></div><h2>Source</h2>
			<div class=content><p><a href='https://www.lydsy.com/JudgeOnline/problemset.php?search=%E9%B8%A3%E8%B0%A2Vfleaking%E6%8F%90%E4%BE%9BSpj'>鸣谢Vfleaking提供Spj</a></p></div><center>[<a href='https://www.lydsy.com/JudgeOnline/submitpage.php?id=3556'>Submit</a>][<a href='https://www.lydsy.com/JudgeOnline/problemstatus.php?id=3556'>Status</a>][<a href='https://www.lydsy.com/JudgeOnline/bbs.php?id=3556'>Discuss</a>]</center>﻿<br>
<a href="https://www.lydsy.com/JudgeOnline/"><span class=red>HOME</span></a>
<a href="javascript:history.go(-1)"><span class=red>Back</span></a>

<hr>
<center>
	<div class="footer">
			<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=ko">한국어</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=cn">中文</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=fa">فارسی</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=en">English</a>&nbsp;
		<a href="https://www.lydsy.com/JudgeOnline/setlang.php?lang=th">ไทย</a>
	<br>		<div>版权所有 &copy;2008-2018 大视野在线测评</div>
		<div>Based on opensource project <a href="http://hustoj.googlecode.com">hustoj</a>.</div>
	</div>
</center>
</body>
</html>
